<!DOCTYPE html>
<html xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:utils="http://java.sun.com/jsf/composite/utils"
	xmlns:sec="http://www.springframework.org/security/tags"
	xmlns:p="http://primefaces.org/ui">

<h:head>
	<link href="resources/styles/main.css" rel="stylesheet" type="text/css" />
</h:head>

<h:body>
	<div id="header">
		<ui:insert name="header">
			<h:outputText value="#{loginbean.username}" />
			<ui:include src="/header.xhtml" />
		</ui:insert>
	</div>
	<h:form id="mainForm">
		<div id="content">
			<ui:insert name="content">

				<p:panel header="User" styleClass="panel"
					rendered="#{facesContext.externalContext.isUserInRole('ROLE_ADMIN')}">
					<h:commandButton onclick="createDlg.show()" value="New user" style="margin-right:20px;" type="button"/>
					
					
					<p:dialog header="create" widgetVar="createDlg" modal="true" height="200" width="400">
						<h:form>
							username:<br/>
							<h:inputText value="#{user.username}"/><br/>
							password:<br/>
							<h:inputSecret value="#{user.password}"/><br/>
							<h:commandButton action = "#{userAction.createUser}" value="create"/>
						</h:form>
					</p:dialog>
					
					<br/>
					existing users:<br/>
					<ui:repeat var="usr" value="#{userAction.users}">
						<h:form>
							<h:inputText value="#{usr.username}" rendered="#{usr.editable}"/>
							<h:outputText value="#{usr.username}" rendered="#{not usr.editable}"/>
							<h:commandLink action="#{userAction.editUserAction(usr)}" value="edit" rendered="#{not usr.editable}"/>
							<h:commandLink action="#{userAction.editUser(usr)}" value="save" rendered="#{usr.editable}"/>
						</h:form>
					</ui:repeat>
					

					
				</p:panel>
				<p:panel header="Person" styleClass="panel">

				</p:panel>
				<p:panel header="Employee" styleClass="panel">

				</p:panel>
				
				<p:panel header="Personal info" rendered="#{facesContext.externalContext.isUserInRole('ROLE_USER')}">
					personal
				</p:panel>

			</ui:insert>
		</div>
	</h:form>
	
	<div id="footer">
		<ui:insert name="footer">
			<ui:include src="/footer.xhtml" />
		</ui:insert>
	</div>

</h:body>
</html>